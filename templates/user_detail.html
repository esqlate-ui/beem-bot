{% extends "base.html" %}
{% block title %}‚Äî {{ u.name }}{% endblock %}
{% block content %}
<div class="page-header flex items-center gap-3 mb-6">
  <a href="/users" class="btn btn-ghost btn-sm">‚Üê –ù–∞–∑–∞–¥</a>
  <div><h2>üë§ {{ u.name }}</h2><p>ID: {{ u.user_id }}</p></div>
</div>

<div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:20px;">
  <div class="card">
    <div class="card-header"><h3>–ü—Ä–æ—Ñ–∏–ª—å</h3></div>
    <div class="card-body" style="line-height:2.2;font-size:14px;">
      <div><span class="text-muted">–ò–º—è:</span> <b>{{ u.name }}</b></div>
      <div><span class="text-muted">–í–æ–∑—Ä–∞—Å—Ç:</span> {{ u.age }}</div>
      <div><span class="text-muted">–ü–æ–ª:</span> {{ u.gender_display }}</div>
      <div><span class="text-muted">Telegram:</span>
        {% if u.username %}<a href="https://t.me/{{ u.username }}" target="_blank" style="color:var(--accent);">@{{ u.username }}</a>{% else %}‚Äî{% endif %}
      </div>
      <div><span class="text-muted">–ò–Ω—Ç–µ—Ä–µ—Å—ã:</span> {{ u.interests_display }}</div>
      <div><span class="text-muted">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è:</span> {{ u.created_display }}</div>
    </div>
  </div>

  <div class="card">
    <div class="card-header"><h3>üîí –ë–∞–Ω / –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</h3></div>
    <div class="card-body">
      {% if u.banned %}
        <div class="badge badge-banned" style="margin-bottom:14px;display:inline-block;">üîí –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –¥–æ {{ u.ban_until_display }}</div>
        <div style="margin-bottom:14px;font-size:13px;color:var(--muted);">–ü—Ä–∏—á–∏–Ω–∞: {{ u.ban_reason or '‚Äî' }}</div>
        <form method="POST" action="/user/{{ u.user_id }}/unban">
          <button class="btn btn-success" type="submit">‚úÖ –†–∞–∑–±–∞–Ω–∏—Ç—å</button>
        </form>
      {% else %}
        <div class="badge badge-active" style="margin-bottom:14px;display:inline-block;">‚úÖ –ê–∫—Ç–∏–≤–µ–Ω</div>
        <form method="POST" action="/user/{{ u.user_id }}/ban" style="display:flex;flex-direction:column;gap:10px;">
          <select name="duration" style="padding:9px 14px;background:var(--surface2);border:1px solid var(--border);border-radius:9px;color:var(--text);font-size:14px;outline:none;">
            <option value="1h">‚è∞ 1 —á–∞—Å</option>
            <option value="24h">‚è∞ 24 —á–∞—Å–∞</option>
            <option value="7d">üìÖ 7 –¥–Ω–µ–π</option>
            <option value="forever">üîí –ù–∞–≤—Å–µ–≥–¥–∞</option>
          </select>
          <input type="text" name="reason" placeholder="–ü—Ä–∏—á–∏–Ω–∞ –±–∞–Ω–∞..." style="padding:9px 14px;background:var(--surface2);border:1px solid var(--border);border-radius:9px;color:var(--text);font-size:14px;outline:none;">
          <button class="btn btn-danger" type="submit">üîí –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å</button>
        </form>
      {% endif %}
    </div>
  </div>
</div>

{% if profile %}
<div class="card mb-4">
  <div class="card-header"><h3>üìã –ê–∫—Ç–∏–≤–Ω–∞—è –∞–Ω–∫–µ—Ç–∞</h3></div>
  <div class="card-body" style="font-size:14px;color:var(--text);">
    {{ profile.description }}<br>
    <span class="text-muted">‚ù§Ô∏è {{ profile.likes }} –ª–∞–π–∫–æ–≤</span>
  </div>
</div>
{% endif %}

<div class="card">
  <div class="card-header"><h3>üí¨ –ß–∞—Ç—ã ({{ chats|length }})</h3></div>
  <div class="table-wrap">
    <table>
      <thead><tr><th>#</th><th>–†–æ–ª—å</th><th>–í—Ä–µ–º—è</th><th></th></tr></thead>
      <tbody>
      {% for c in chats %}
        <tr>
          <td style="color:var(--muted);">#{{ c.id }}</td>
          <td>{% if c.sender_id == u.user_id %}üì® –ù–∞–ø–∏—Å–∞–ª{% else %}üì¨ –ù–∞–ø–∏—Å–∞–ª–∏{% endif %}</td>
          <td class="text-muted">{{ fmt_time(c.created_at) }}</td>
          <td><a href="/chat/{{ c.id }}" class="btn btn-ghost btn-sm">–û—Ç–∫—Ä—ã—Ç—å</a></td>
        </tr>
      {% else %}
        <tr><td colspan="4" style="text-align:center;padding:24px;color:var(--muted);">–ù–µ—Ç —á–∞—Ç–æ–≤</td></tr>
      {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
